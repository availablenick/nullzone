$post = $("#<%= @rating.post.id %>").next();
if (<%= @rating.value %> > 0) {
  $post.find(".rating-btns").find("form:first")
    .remove()
    .end()
    .prepend('<%= escape_javascript(render 'button', method: 'delete', model: @rating) %>');

  $post.find(".rating-btns").find("form:last")
    .remove()
    .end()
    .append("<%= escape_javascript(render 'button', method: 'patch', model: @rating, value: -1) %>");

} else {
  $post.find(".rating-btns").find("form:first")
    .remove()
    .end()
    .prepend("<%= escape_javascript(render 'button', method: 'patch', model: @rating, value: 1) %>");
    
  $post.find(".rating-btns").find("form:last")
    .remove()
    .end()
    .append('<%= escape_javascript(render 'button', method: 'delete', model: @rating) %>');
}

ratingSum = <%= @rating.post.ratings.sum('value') %>;
$bold = $("<b></b>").html(ratingSum);
if (ratingSum < 0) {
  $bold.css("color", "red");
}

$post.find(".rating")
  .html("")
  .append("Total: ", $bold);
