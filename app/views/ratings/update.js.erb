$post = $("#<%= @rating.post.id %>").parent();
if (<%= @rating.value %> > 0) {
  $post.find(".rating-btns").find("form:first")
    .remove()
    .end()
    .prepend("<%= escape_javascript(button_to '+1', @rating, method: :delete, remote: true, class: 'positive') %>");

  $post.find(".rating-btns").find("form:last")
    .remove()
    .end()
    .append("<%= escape_javascript(render 'form_button', rating: @rating, value: -1, model: @rating) %>");

} else {
  $post.find(".rating-btns").find("form:first")
    .remove()
    .end()
    .prepend("<%= escape_javascript(render 'form_button', rating: @rating, value: 1, model: @rating) %>");
    
  $post.find(".rating-btns").find("form:last")
    .remove()
    .end()
    .append("<%= escape_javascript(button_to '-1', @rating, method: :delete, remote: true, class: 'negative') %>");
}

ratingSum = <%= @rating.post.ratings.sum('value') %>;
$bold = $("<b></b>").html(ratingSum);
if (ratingSum < 0) {
  $bold.css("color", "red");
}

$post.find(".rating")
  .html("")
  .append("Total: ", $bold);
